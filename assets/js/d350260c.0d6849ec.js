"use strict";(globalThis.webpackChunkdocs=globalThis.webpackChunkdocs||[]).push([[504],{2003:(n,e,i)=>{i.r(e),i.d(e,{assets:()=>o,contentTitle:()=>d,default:()=>h,frontMatter:()=>l,metadata:()=>t,toc:()=>c});const t=JSON.parse('{"id":"ffi","title":"Foreign Function Interface (FFI)","description":"Droplet allows calling external functions written in C through FFI.","source":"@site/docs/ffi.md","sourceDirName":".","slug":"/ffi","permalink":"/docs/docs/ffi","draft":false,"unlisted":false,"editUrl":"https://github.com/droplet-lang/lang/edit/main/website/docs/ffi.md","tags":[],"version":"current","sidebarPosition":9,"frontMatter":{"sidebar_position":9},"sidebar":"tutorialSidebar","previous":{"title":"Native Functions","permalink":"/docs/docs/native_fn"},"next":{"title":"Package Manager (Drip)","permalink":"/docs/docs/drip"}}');var r=i(4848),s=i(8453);const l={sidebar_position:9},d="Foreign Function Interface (FFI)",o={},c=[{value:"\ud83d\udd39 Supported Signatures",id:"-supported-signatures",level:2},{value:"\u270f\ufe0f Example: C Library",id:"\ufe0f-example-c-library",level:2},{value:"\ud83d\udd04 Using FFI in Droplet",id:"-using-ffi-in-droplet",level:2},{value:"\ud83e\udde0 Notes",id:"-notes",level:2}];function a(n){const e={br:"br",code:"code",h1:"h1",h2:"h2",header:"header",hr:"hr",li:"li",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,s.R)(),...n.components};return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)(e.header,{children:(0,r.jsx)(e.h1,{id:"foreign-function-interface-ffi",children:"Foreign Function Interface (FFI)"})}),"\n",(0,r.jsxs)(e.p,{children:["Droplet allows calling ",(0,r.jsx)(e.strong,{children:"external functions"})," written in C through FFI.",(0,r.jsx)(e.br,{}),"\n","This is useful for extending the language or using existing libraries."]}),"\n",(0,r.jsx)(e.hr,{}),"\n",(0,r.jsx)(e.h2,{id:"-supported-signatures",children:"\ud83d\udd39 Supported Signatures"}),"\n",(0,r.jsx)(e.p,{children:"FFI currently supports three types of function signatures:"}),"\n",(0,r.jsxs)(e.table,{children:[(0,r.jsx)(e.thead,{children:(0,r.jsxs)(e.tr,{children:[(0,r.jsx)(e.th,{children:"Signature"}),(0,r.jsx)(e.th,{children:"Meaning"})]})}),(0,r.jsxs)(e.tbody,{children:[(0,r.jsxs)(e.tr,{children:[(0,r.jsx)(e.td,{children:(0,r.jsx)(e.code,{children:'"0"'})}),(0,r.jsx)(e.td,{children:(0,r.jsx)(e.code,{children:"int(int, int)"})})]}),(0,r.jsxs)(e.tr,{children:[(0,r.jsx)(e.td,{children:(0,r.jsx)(e.code,{children:'"1"'})}),(0,r.jsx)(e.td,{children:(0,r.jsx)(e.code,{children:"int(int)"})})]}),(0,r.jsxs)(e.tr,{children:[(0,r.jsx)(e.td,{children:(0,r.jsx)(e.code,{children:'"2"'})}),(0,r.jsx)(e.td,{children:(0,r.jsx)(e.code,{children:"double(double, double)"})})]})]})]}),"\n",(0,r.jsx)(e.hr,{}),"\n",(0,r.jsx)(e.h2,{id:"\ufe0f-example-c-library",children:"\u270f\ufe0f Example: C Library"}),"\n",(0,r.jsxs)(e.p,{children:["Create a C file ",(0,r.jsx)(e.code,{children:"mathlib.c"}),":"]}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-c",children:"#include <math.h>\n\nint add_numbers(int a, int b) {\n    return a + b;\n}\n\nint square(int x) {\n    return x * x;\n}\n\ndouble power(double base, double exp) {\n    return pow(base, exp);\n}\n"})}),"\n",(0,r.jsxs)(e.p,{children:["Compile it to a shared library ",(0,r.jsx)(e.code,{children:"libmath.so"})," (Linux) or ",(0,r.jsx)(e.code,{children:"mathlib.dll"})," (Windows)."]}),"\n",(0,r.jsx)(e.hr,{}),"\n",(0,r.jsx)(e.h2,{id:"-using-ffi-in-droplet",children:"\ud83d\udd04 Using FFI in Droplet"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{className:"language-rust",children:'@ffi("./libmath.so", sig="0")\nfn add_numbers(a: int, b: int) -> int\n\n@ffi("./libmath.so", sig="1")\nfn square(x: int) -> int\n\n@ffi("./libmath.so", sig="2")\nfn power(base: float, exp: float) -> float\n\nfn main() {\n    let sum = add_numbers(10, 32)\n    println("10 + 32 =", sum)\n\n    let sq = square(7)\n    println("7^2 =", sq)\n\n    let pow_result = power(2.0, 10.0)\n    println("2^10 =", pow_result)\n}\n'})}),"\n",(0,r.jsx)(e.p,{children:"Output:"}),"\n",(0,r.jsx)(e.pre,{children:(0,r.jsx)(e.code,{children:"10 + 32 = 42\n7^2 = 49\n2^10 = 1024.0\n"})}),"\n",(0,r.jsx)(e.hr,{}),"\n",(0,r.jsx)(e.h2,{id:"-notes",children:"\ud83e\udde0 Notes"}),"\n",(0,r.jsxs)(e.ul,{children:["\n",(0,r.jsxs)(e.li,{children:["Use ",(0,r.jsx)(e.code,{children:'@ffi(path, sig="...")'})," to declare an external function."]}),"\n",(0,r.jsxs)(e.li,{children:["The ",(0,r.jsx)(e.code,{children:"sig"})," must match the C function signature."]}),"\n",(0,r.jsxs)(e.li,{children:["FFI allows Droplet to ",(0,r.jsx)(e.strong,{children:"interact with existing C libraries"})," safely."]}),"\n"]})]})}function h(n={}){const{wrapper:e}={...(0,s.R)(),...n.components};return e?(0,r.jsx)(e,{...n,children:(0,r.jsx)(a,{...n})}):a(n)}},8453:(n,e,i)=>{i.d(e,{R:()=>l,x:()=>d});var t=i(6540);const r={},s=t.createContext(r);function l(n){const e=t.useContext(s);return t.useMemo(function(){return"function"==typeof n?n(e):{...e,...n}},[e,n])}function d(n){let e;return e=n.disableParentContext?"function"==typeof n.components?n.components(r):n.components||r:l(n.components),t.createElement(s.Provider,{value:e},n.children)}}}]);