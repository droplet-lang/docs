"use strict";(globalThis.webpackChunkdocs=globalThis.webpackChunkdocs||[]).push([[504],{2003:(n,e,r)=>{r.r(e),r.d(e,{assets:()=>d,contentTitle:()=>o,default:()=>h,frontMatter:()=>l,metadata:()=>t,toc:()=>c});const t=JSON.parse('{"id":"ffi","title":"Foreign Function Interface (FFI)","description":"Droplet allows calling external functions written in C through FFI.","source":"@site/docs/ffi.md","sourceDirName":".","slug":"/ffi","permalink":"/docs/docs/ffi","draft":false,"unlisted":false,"editUrl":"https://github.com/droplet-lang/lang/edit/main/website/docs/ffi.md","tags":[],"version":"current","sidebarPosition":9,"frontMatter":{"sidebar_position":9},"sidebar":"tutorialSidebar","previous":{"title":"Native Functions","permalink":"/docs/docs/native_fn"},"next":{"title":"Package Manager (Drip)","permalink":"/docs/docs/drip"}}');var s=r(4848),i=r(8453);const l={sidebar_position:9},o="Foreign Function Interface (FFI)",d={},c=[{value:"\ud83d\udd39 Supported Signatures",id:"-supported-signatures",level:2},{value:"\u270f\ufe0f Example: C Library",id:"\ufe0f-example-c-library",level:2},{value:"\ud83d\udd04 Using FFI in Droplet",id:"-using-ffi-in-droplet",level:2},{value:"\ud83e\udde0 Notes",id:"-notes",level:2}];function a(n){const e={blockquote:"blockquote",code:"code",h1:"h1",h2:"h2",header:"header",hr:"hr",li:"li",p:"p",pre:"pre",strong:"strong",table:"table",tbody:"tbody",td:"td",th:"th",thead:"thead",tr:"tr",ul:"ul",...(0,i.R)(),...n.components};return(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(e.header,{children:(0,s.jsx)(e.h1,{id:"foreign-function-interface-ffi",children:"Foreign Function Interface (FFI)"})}),"\n",(0,s.jsxs)(e.p,{children:["Droplet allows calling ",(0,s.jsx)(e.strong,{children:"external functions"})," written in C through FFI.\nThis is useful for extending the language or using existing libraries."]}),"\n",(0,s.jsx)(e.hr,{}),"\n",(0,s.jsx)(e.h2,{id:"-supported-signatures",children:"\ud83d\udd39 Supported Signatures"}),"\n",(0,s.jsxs)(e.p,{children:["FFI now supports ",(0,s.jsx)(e.strong,{children:"human-readable signature strings"})," instead of numeric codes."]}),"\n",(0,s.jsxs)(e.table,{children:[(0,s.jsx)(e.thead,{children:(0,s.jsxs)(e.tr,{children:[(0,s.jsx)(e.th,{children:"Signature"}),(0,s.jsx)(e.th,{children:"Meaning"})]})}),(0,s.jsxs)(e.tbody,{children:[(0,s.jsxs)(e.tr,{children:[(0,s.jsx)(e.td,{children:(0,s.jsx)(e.code,{children:'"i,i->i"'})}),(0,s.jsx)(e.td,{children:(0,s.jsx)(e.code,{children:"int64_t(int64_t, int64_t)"})})]}),(0,s.jsxs)(e.tr,{children:[(0,s.jsx)(e.td,{children:(0,s.jsx)(e.code,{children:'"i->i"'})}),(0,s.jsx)(e.td,{children:(0,s.jsx)(e.code,{children:"int64_t(int64_t)"})})]}),(0,s.jsxs)(e.tr,{children:[(0,s.jsx)(e.td,{children:(0,s.jsx)(e.code,{children:'"f,f->f"'})}),(0,s.jsx)(e.td,{children:(0,s.jsx)(e.code,{children:"double(double, double)"})})]}),(0,s.jsxs)(e.tr,{children:[(0,s.jsx)(e.td,{children:(0,s.jsx)(e.code,{children:'"b->b"'})}),(0,s.jsx)(e.td,{children:(0,s.jsx)(e.code,{children:"bool(bool)"})})]}),(0,s.jsxs)(e.tr,{children:[(0,s.jsx)(e.td,{children:(0,s.jsx)(e.code,{children:'"s->s"'})}),(0,s.jsxs)(e.td,{children:[(0,s.jsx)(e.code,{children:"string -> string"})," (return only)"]})]})]})]}),"\n",(0,s.jsxs)(e.blockquote,{children:["\n",(0,s.jsxs)(e.p,{children:["Here, ",(0,s.jsx)(e.code,{children:"i"})," = int64, ",(0,s.jsx)(e.code,{children:"f"})," = double, ",(0,s.jsx)(e.code,{children:"b"})," = boolean, ",(0,s.jsx)(e.code,{children:"s"})," = string.\n",(0,s.jsx)(e.strong,{children:"Note:"})," Strings can currently only be returned from C; passing strings as arguments is not supported yet."]}),"\n"]}),"\n",(0,s.jsx)(e.hr,{}),"\n",(0,s.jsx)(e.h2,{id:"\ufe0f-example-c-library",children:"\u270f\ufe0f Example: C Library"}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-c",children:'#include <stdint.h>\n#include <math.h>\n\nint64_t add_numbers(int64_t a, int64_t b) {\n    return a + b;\n}\n\nint64_t square(int64_t x) {\n    return x * x;\n}\n\ndouble power(double base, double exp) {\n    return pow(base, exp);\n}\n\n// Example string return\nconst char* greet() {\n    return "Hello from C!";\n}\n'})}),"\n",(0,s.jsxs)(e.p,{children:["Compile it to a shared library ",(0,s.jsx)(e.code,{children:"libmath.so"})," (Linux) or ",(0,s.jsx)(e.code,{children:"mathlib.dll"})," (Windows)."]}),"\n",(0,s.jsx)(e.hr,{}),"\n",(0,s.jsx)(e.h2,{id:"-using-ffi-in-droplet",children:"\ud83d\udd04 Using FFI in Droplet"}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{className:"language-rust",children:'@ffi("./mathlib.dll", sig="i,i->i")\nfn add_numbers(a: int, b: int) -> int\n\n@ffi("./mathlib.dll", sig="i->i")\nfn square(x: int) -> int\n\n@ffi("./mathlib.dll", sig="f,f->f")\nfn power(base: float, exp: float) -> float\n\n@ffi("./mathlib.dll", sig="s->s")\nfn greet() -> string\n\nfn main() {\n    let sum = add_numbers(10, 32)\n    println("10 + 32 =", sum)\n\n    let sq = square(7)\n    println("7^2 =", sq)\n\n    let pow_result = power(2.0, 10.0)\n    println("2^10 =", pow_result)\n\n    let message = greet()\n    println(message)  // Output: "Hello from C!"\n}\n'})}),"\n",(0,s.jsx)(e.p,{children:"Output:"}),"\n",(0,s.jsx)(e.pre,{children:(0,s.jsx)(e.code,{children:"10 + 32 = 42\n7^2 = 49\n2^10 = 1024.0\nHello from C!\n"})}),"\n",(0,s.jsx)(e.hr,{}),"\n",(0,s.jsx)(e.h2,{id:"-notes",children:"\ud83e\udde0 Notes"}),"\n",(0,s.jsxs)(e.ul,{children:["\n",(0,s.jsxs)(e.li,{children:["Use ",(0,s.jsx)(e.code,{children:'@ffi(path, sig="...")'})," to declare an external function."]}),"\n",(0,s.jsxs)(e.li,{children:["Droplet currently supports ",(0,s.jsx)(e.strong,{children:"integers, floats, booleans, and string returns"}),"."]}),"\n",(0,s.jsxs)(e.li,{children:[(0,s.jsx)(e.strong,{children:"Strings can only be returned"})," from C functions; passing strings as arguments is not yet supported."]}),"\n",(0,s.jsxs)(e.li,{children:[(0,s.jsx)(e.strong,{children:"Coming soon:"})," FFI support for ",(0,s.jsx)(e.strong,{children:"objects, arrays, and more complex types"}),"."]}),"\n"]})]})}function h(n={}){const{wrapper:e}={...(0,i.R)(),...n.components};return e?(0,s.jsx)(e,{...n,children:(0,s.jsx)(a,{...n})}):a(n)}},8453:(n,e,r)=>{r.d(e,{R:()=>l,x:()=>o});var t=r(6540);const s={},i=t.createContext(s);function l(n){const e=t.useContext(i);return t.useMemo(function(){return"function"==typeof n?n(e):{...e,...n}},[e,n])}function o(n){let e;return e=n.disableParentContext?"function"==typeof n.components?n.components(s):n.components||s:l(n.components),t.createElement(i.Provider,{value:e},n.children)}}}]);